---
title: "Juvenile Snowshoe Hares in Bonanza Creek Experimental Forest: Exploratory Report"
author: "Catherine Takata"
date: "20 Novemeber 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(lubridate)
library(effsize)
library(broom)
library(kableExtra)
library(ggbeeswarm)
```


### 1. Introduction 
In this exploratory report, based on the findings of "Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present," we identified differences and trends among observations on the Snowshoe hare of Bonanza Creek, Alaska, United States (Kielland et al. (2017). Female and male juvenile hare weights were compared and the relationship between weight and hind foot length was explored. Through data visualization, a series of test sampling, summary statistics, and regression calculation, this report provides an overview of a quanatative analysis of this keystone species. 


### 2. Data and analyses
A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.


#### Read in data 
```{r, include=FALSE}
bonanza_hares <- read.csv(here("data", "bonanza_hares.csv")) %>% 
  mutate(site = case_when(
    grid %in% "bonrip" ~ "Riparian",
    grid %in% "bonmat" ~ "Mature",
    grid %in% "bonbs" ~ "Lowland"
  ))
```

```{r, include=FALSE}
# in a pipe sequence, change the initial date into a different format and use mutate() function to add this new "formatted" column to the data set
# then mutate() a new column for specifically for year, in order to easily filter data 
hares_by_year <- bonanza_hares %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new))
```


### 3. Preliminary Results 

```{r, include=FALSE}
hare_counts <- hares_by_year %>% 
  count(age,year) %>% 
  filter(age == "j")

ggplot(data = hare_counts, aes(x = year, y = n)) + 
  geom_col(alpha = 0.5) +
  labs(title = "Number of Bonanza Hares per Year",
       subtitle = "Bonanza Creek (Takata, 2020)",
       x = "Year",
       y = "Number of Hares")
```


#### A. Weight based on sex comparison and descriptive statistics 
```{r}
juvenile_hares <- bonanza_hares %>% 
  filter(age == "j")


juvenile_hares_stats <- juvenile_hares %>% 
  group_by(sex) %>% 
  summarize(mean = mean(weight, na.rm = TRUE),
            sd = sd(weight, na.rm = TRUE),
            sample = n())
```

**Table 1.** Descriptive statistics (mean, standard deviation, and sample size) for recorded juvenile hare weight based on sex. Data: Kielland et al. (2017)
```{r}
juvenile_hares_stats %>% 
  kbl(col.names = c("Sex", "Mean Weight (g)", "Standard Deviation (g)", "Sample Size")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```


```{r, fit.align = "center"}
ggplot(data = juvenile_hares, aes(x = sex, y = weight)) +
  geom_beeswarm(aes(color = sex)) +
  scale_color_manual(values = c("goldenrod2","cyan4"), na.value ="coral") +
  geom_boxplot(fill = NA, width = 0.2, outlier.color = NA) +
  stat_summary(fun=mean, 
               geom="point", 
               shape=20, 
               size=4, 
               color="black", 
               fill="black") +
  theme_minimal() +
  labs(x = "Sex",
       y = "Weight (g)",
       title = "Distribution of Female and Male Juvenile Hare Weight",
       subtitle = "Bonanza Creek, Alaska, US, 1999-2012\n(Takata, 2020)",
       caption = "Figure 1") + 
  facet_wrap(~site)

```

**Figure 1.** Weight (g) observations of female and male juvenile Bonanza Snowshoe hares in three sampling areas: Lowland, Mature, and Riparian. Points correspond to indviidual hare weight observations: gold (female), cyan (male), and coral (N/A, in which sex could not be determined). Overlayed box plots endpoints indicate the variation of measurents from the 1st and 3rd quartiles; the black line and point indciate the median and mean value for each sex, respectively. Data: Data: Kielland et al. (2017)


```{r}
# Create vectors of for female and male hares based on weight. 
weight_f <- bonanza_hares %>% 
  filter(sex == "f") %>% 
  pull(weight)

weight_m <- bonanza_hares %>% 
  filter(sex == "m") %>% 
  pull(weight)

# Plot histograms & qq-plots to check assumptions
hist(weight_f)    # looks normal 
qqnorm(weight_f)  # relatively linear 

hist(weight_m)    # possibly negatively skewed 
qqnorm(weight_m)  # relatively linear 


# Overall: assumptions of normality hold, & sample size additionally >> Central Limit Theorem (means will be normally distributed). Two-sample t-test OK for means comparison! 


# Inital 2 sample t test 
hare_weight_ttest <- t.test(weight_f, weight_m)
hare_weight_ttest

# Get effect size
cohen.d(weight_f, weight_m, na.rm = TRUE)
```




#### B. Relationship between juvenile weight and hind foot length 
```{r}
# Obtain a linear regression 
hare_lm <- lm(weight ~ hindft, data = juvenile_hares)

# Get tidy versions of the model output to call later on in text
hare_lm_tidy <- tidy(hare_lm)
hare_lm_glance <- glance(hare_lm)

# Plot and view model diagnostics:
plot(hare_lm)

# Calculate a Pearson's r correlation
hare_cor <- cor.test(bonanza_hares$hindft, bonanza_hares$weight)

# Tidy version of correlation output: 
hare_cor_tidy <- tidy(hare_cor)

```


```{r}
ggplot(data = juvenile_hares, aes(x = hindft, y = weight)) +
  geom_point(aes(color = sex, pch = sex), size = 2) +
  scale_color_manual(values = c("goldenrod2","cyan4", "coral"), 
                     name = "Sex") +
  scale_shape_manual(values = c(16,17,18), 
                     name = "Sex") +
  geom_smooth(method = "lm", se = FALSE, color = "gray30") +
  theme_minimal() +
  labs(title = "Relationship of Juvenile Hare Weight and Hind Foot Length",
       subtitle = "Bonanza Creek, Alaska, US",
    x = "Hind Foot Length (mm)",
       y = "Weight (g)") +
  theme(legend.position = c(0.15, 0.7))
```
```




















